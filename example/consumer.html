<html>
<meta charset="utf-8" /> 
<head>


</head>
<body>
Loading BIG IoT...
</body>

<script type='text/javascript' src='../dist/bigiot.js'></script>

<script type='text/javascript'>
// Replace with require('bigiot-js')
const { consumer: BigIotConsumer, offering: BigIotOffering } = bigiot;


// Configure your consumer API keys
const config = {
  id: '',
  secret: '',
  //corsproxy: 'http://localhost:8080',
  //corsproxy: 'https://cors-anywhere.herokuapp.com', // Rate-limited, testing only
  marketplace: undefined, // default
};

// Create a new consumer instance with your credentials
const consumer = new BigIotConsumer(config.id, config.secret, undefined, config.corsproxy);

// Authenticate your consumer
consumer.authenticate().then(() => {
  // authentication is done
  console.log('Consumer authentication successful!');

  const query = new BigIotOffering('Parking spaces', 'urn:big-iot:ParkingSpaceCategory');
  // Remove requirements we don't care about
  delete query.license;
  delete query.extent;
  delete query.price;

  consumer.subscribe('Thingful-Thingful-barcelona_air_temperature')
    .then((offering) => {
      console.log('Offering subscription successful!');

      const accessParameters = {
        longitude: 9.2,
        latitude: 42.0,
        radius: 10000000,
      };

      return consumer.access(offering, accessParameters).then((response) => {
        console.log('Response: ', response);
      });
    }, (err) => {
        console.log('subscription error', err);
    });
}).catch((err) => {
  console.log('err', err);
});
</script>
</html>

